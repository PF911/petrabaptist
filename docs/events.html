<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
<title>Events – Petra Baptist Church</title>

<style>
  *{margin:0;padding:0;box-sizing:border-box;}
  body{
    font-family:Arial,sans-serif;
    background:linear-gradient(to bottom,#2e6aa9,#338cd0);
    overflow:hidden;
    height:100vh;
  }

  .app-frame{
    width:100%;
    max-width:420px;
    margin:0 auto;
    height:100vh;
    display:flex;
    flex-direction:column;
    position:relative;
  }

  .top-nav{
    background:rgba(29,79,122,0.95);
    padding:12px 16px;
    display:flex;
    align-items:center;
    gap:12px;
    box-shadow:0 2px 8px rgba(0,0,0,0.3);
    z-index:100;
  }
  .back-button,.nav-button{
    background:rgba(255,255,255,0.2);
    border:none;
    color:white;
    font-size:20px;
    width:40px;
    height:40px;
    border-radius:8px;
    cursor:pointer;
    display:flex;
    align-items:center;
    justify-content:center;
  }
  .nav-title{
    flex:1;
    color:white;
    font-size:18px;
    font-weight:bold;
  }

  .browser-content{flex:1;position:relative;background:white;}
  iframe{
    width:100%;
    height:100%;
    border:none;
    background:white;
  }

  .loading-overlay{
    position:absolute;top:0;left:0;right:0;bottom:0;
    background:white;
    display:flex;flex-direction:column;align-items:center;justify-content:center;
    z-index:50;
    transition:opacity 0.3s;
  }
  .loading-overlay.hidden{opacity:0;pointer-events:none;}
  .spinner{
    width:50px;height:50px;border:4px solid #e0e0e0;border-top:4px solid #2e6aa9;
    border-radius:50%;animation:spin 1s linear infinite;
  }
  @keyframes spin{100%{transform:rotate(360deg)}}
  .loading-text{margin-top:12px;color:#2e6aa9;font-size:14px;}

  .error-message{
    background:#fff3cd;
    border:2px solid #ffc107;
    color:#856404;
    padding:20px;
    margin:20px;
    border-radius:8px;
    text-align:center;
  }
  .error-message button{
    margin-top:15px;
    background:#2e6aa9;
    color:white;
    border:none;
    padding:12px 24px;
    border-radius:6px;
    cursor:pointer;
    font-size:16px;
    font-weight:bold;
  }

  .footer-menu{
    background:#1d4f7a;
    padding:12px 8px;
    display:flex;justify-content:space-around;
  }
  .menu-item{
    background:rgba(255,255,255,0.15);
    border:none;
    color:white;
    padding:10px 16px;
    border-radius:8px;
    font-weight:bold;
    cursor:pointer;
  }
  .menu-item.active{
    background:rgba(255,255,255,0.6);
    color:#1d4f7a;
  }
</style>
</head>

<body>
<div class="app-frame">

  <div class="top-nav">
    <button class="back-button" onclick="goHome()">←</button>
    <div class="nav-title">Events</div>
    <button class="nav-button" onclick="openExternal()">⧉</button>
  </div>

  <div class="browser-content">
    <div id="loadingOverlay" class="loading-overlay">
      <div class="spinner"></div>
      <p class="loading-text">Loading Events...</p>
    </div>

    <div id="errorMessage" style="display:none;" class="error-message">
      <h3>Unable to Load Events</h3>
      <p>The events page cannot be displayed in an embedded view.</p>
      <button onclick="openExternal()">Open in Browser</button>
    </div>

    <iframe
      id="eventsFrame"
      src="https://petrabaptist.com/events"
      onload="handleLoad()"
      onerror="handleError()">
    </iframe>
  </div>

  <div class="footer-menu">
    <button class="menu-item" onclick="goHome()">Home</button>
    <button class="menu-item" onclick="navigate('sermons.html')">Sermons</button>
    <button class="menu-item active">Events</button>
    <button class="menu-item" onclick="navigate('website.html')">Website</button>
  </div>

</div>

<script>
  const eventsUrl = 'https://petrabaptist.com/events';
  let loadTimeout;

  function goHome(){window.location.href='index.html';}
  function navigate(p){window.location.href=p;}

  function handleLoad(){
    clearTimeout(loadTimeout);
    const overlay = document.getElementById('loadingOverlay');
    overlay.classList.add('hidden');
  }

  function handleError(){
    clearTimeout(loadTimeout);
    showError();
  }

  function showError(){
    const overlay = document.getElementById('loadingOverlay');
    const error = document.getElementById('errorMessage');
    const frame = document.getElementById('eventsFrame');
    
    overlay.classList.add('hidden');
    frame.style.display = 'none';
    error.style.display = 'block';
  }

  function openExternal(){
    window.open(eventsUrl, '_blank');
  }

  // Set timeout for loading
  window.addEventListener('load', () => {
    loadTimeout = setTimeout(() => {
      // If still loading after 4 seconds, assume it failed
      const overlay = document.getElementById('loadingOverlay');
      if (!overlay.classList.contains('hidden')) {
        showError();
      }
    }, 10000);
  });
</script>

</body>
</html>